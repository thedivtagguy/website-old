import{s,r as O,t as N,a as P,f as T,j as q,c as w,i as z,m as B,b as Y,d as k,e as j,g as C,h as F,k as E,l as G,n as I}from"./vendor.02cc420a.js";const K=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function p(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(t){if(t.ep)return;t.ep=!0;const n=p(t);fetch(t.href,n)}};K();const R=s("#year_label").append("label").text("Year: "),V=s("#currentCountry").append("label"),W=s("#currentYear").append("label"),H=s("#currentYield").append("label");let J=s("#chart");const Q=O(1961,2019),g=[],x=N().domain([3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60]).range(P[9]),A=s("#legendOne").append("div").attr("class","flex flex-col justify-items-start items-start"),L=x.domain().map(function(r){return{color:x(r),label:r}}),b=s("#dropDownCrop").append("select").attr("class","block w-12 w-full text-md px-4 py-3 pr-8 leading-tight text-gray-700 bg-gray-200 border border-gray-200 rounded appearance-none focus:outline-none focus:bg-white focus:border-gray-500"),v=s("#dropDownYear").append("input").attr("type","range").attr("class","range range-primary bg-gray-200 w-24 rounded-xl").attr("min",1961).attr("max",2018).attr("value",2018).attr("id","sliderYear");v.selectAll("option").data(Q).enter().append("option").attr("value",r=>r).text(r=>r);T("%");Promise.all([q("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson"),w("/data/crop_data.csv",function(r){g.push(r)})]).then(function(r){A.append("div").attr("class","text-center text-black py-2 font-bold").text("Yield (t/ha)"),A.append("ul").attr("class","flex flex-wrap").selectAll("li").data(L.slice(0,8)).enter().append("li").style("background-color",function(a){return a.color}).style("width","40px").html("<span class='px-2'></span>"),A.append("ul").attr("class","flex flex-wrap text-center").selectAll("li").data(L.slice(0,8)).enter().append("li").attr("class","text-black").style("width","40px").text(function(a){return a.label});const i=Array.from(new Set(g.map(a=>a.crop)));b.selectAll("option").data(i).enter().append("option").attr("value",a=>a).text(a=>a);const p=z().projection(B().scale(100).translate([300,300])),l=r[0].features;let t=J.append("svg").attr("width",700).attr("height",450).selectAll("path").data(l).enter().append("path").attr("d",p).attr("id",a=>a.properties.name).attr("fill",a=>{const d=v.property("value"),f=b.property("value"),o=g.filter(u=>u.year===d&&u.crop===f).find(u=>u.entity===a.properties.name);return o>0?x(o):"#ccc"}).attr("stroke","#000").attr("stroke-width",.2);function n(a,d){R.text(a),W.html("<p> Yield for <span class='badge inline badge-primary'> "+a+"</span> is </p>"),t.attr("fill",f=>{const e=g.find(o=>o.year===a&&o.entity===f.properties.name&&o.crop===d);if(e){let o=e.crop_production;if(o>0)return x(o)}return"#ccc"}).on("mouseover",function(f){V.html("<p>"+f.target.__data__.properties.name+"</p>");const e=g.find(u=>u.year===a&&u.entity===f.target.__data__.properties.name&&u.crop===d);s(this).attr("stroke","#000"),Y("path").attr("opacity",.6),s(this).attr("opacity",1),console.log(e);let o=e.crop_production;o=Math.round(o*100)/100,H.html("<p> "+o+"<span class='text-sm text-gray-400'> tonnes/hectare</span> </p>")}).on("mouseleave",function(f){s(this).attr("stroke","#eee"),Y("path").attr("opacity",1)})}function h(){const a=v.property("value"),d=b.property("value");n(a,d)}v.on("change",h),b.on("change",h),n(2018,"Wheat")});const c={top:20,right:50,bottom:30,left:160},_=960-c.left-c.right,S=2500-c.top-c.bottom;let $=s("#chart2").append("div").attr("id","chartArea").classed("chart",!0).append("svg").attr("width",_+c.left+c.right).attr("height",S+c.top+c.bottom).append("g").attr("transform","translate("+c.left+","+c.top+")"),U=s("#chart2").append("svg").attr("width",_+c.left+c.right).attr("height",40).append("g").attr("transform","translate("+c.left+", 0)");w("data/land_use.csv").then(function(r){const i=Array.from(new Set(r.map(e=>e.year))),p=Array.from(new Set(r.map(e=>e.entity)));p.reverse();const l=k().range([0,_]).domain(i).padding(.01);let t=s("#chart2").append("div").style("opacity",0).attr("class","tooltip").style("background-color","white").style("border","solid").style("color","black").attr("class","text-left").style("border-width","2px").style("border-radius","5px").style("padding","5px");const n=function(e,o){t.style("opacity",1),s(this).style("stroke","black").style("stroke-width","0.3px").style("opacity",1)},h=function(e,o){let u=`<div class='row'>
    
    <div class='col-md-12'>
        <b>Country: </b>`+o.entity+`
   </div>
    <div class='col-md-12'>
        <b>Year: </b>`+o.year+`
    </div>
    <div class='col-md-12'>
        <b>Change in land use since previous year: </b>`+o.cumChange+`
    </div>`;console.log(e.x,e.y),console.log("Modified:",.8*e.x,.8*e.y),t.html(u).style("left",.8*e.x+"px").style("top",.8*e.y+"px").style("position","absolute")},a=function(e,o){t.style("opacity",0),s(this).style("stroke","none").style("opacity",.8)},d=k().range([S,0]).domain(p).padding(.01);U.call(j(l).tickValues(i.filter((e,o)=>!(o%10)))).selectAll("text").style("color","black").style("position","fixed").attr("transform","translate(-10,10)rotate(-45)").style("text-anchor","end"),$.append("g").call(C(d)).selectAll("text").style("color","black").attr("transform","translate(-10,0)").style("text-anchor","end");const f=F().domain([0,E(r,e=>e.change)]).interpolator(G);$.selectAll().data(r,function(e){return e.year+":"+e.entity}).join("rect").attr("x",function(e){return l(e.year)}).attr("y",function(e){return d(e.entity)}).attr("width",l.bandwidth()).attr("height",d.bandwidth()).style("fill",function(e){return f(e.change)}).style("stroke-width",4).style("stroke","none").style("opacity",.8).on("mouseover",n).on("mousemove",h).on("mouseleave",a)});const y={top:10,right:28,bottom:60,left:100},M=445-y.left-y.right,D=600-y.top-y.bottom,m=s("#chartThree").append("svg").attr("width",M+y.left+y.right).attr("height",D+y.top+y.bottom).append("g").attr("transform",`translate(${y.left}, ${y.top})`);w("data/land-use-per-kg-cleaned.csv").then(function(r){r.sort(function(t,n){return n.land-t.land});const i=m.append("defs").append("linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");i.append("stop").attr("offset","0%").attr("stop-color","#807DBA").attr("stop-opacity",1),i.append("stop").attr("offset","100%").attr("stop-color","#3F007D").attr("stop-opacity",1);const p=I().domain([0,400]).range([0,M]),l=k().range([0,D]).domain(r.map(t=>t.entity)).padding(.1);m.append("g").call(C(l)).selectAll("text").attr("class","text-gray-600 font-bold"),m.append("g").attr("transform",`translate(0, ${D})`).call(j(p)).selectAll("text").attr("class","text-gray-600").attr("transform","translate(-7,10)rotate(-45)").style("text-anchor","end"),m.selectAll("myRect").data(r).join("rect").attr("x",p(0)).attr("y",t=>l(t.entity)).attr("width",t=>p(t.land)).attr("height",l.bandwidth()).attr("fill","url(#gradient)"),m.selectAll("myText").data(r).join("text").attr("x",t=>p(t.land)+5).attr("y",t=>l(t.entity)+l.bandwidth()).text(t=>t.land+" m2").attr("class","text-gray-600").attr("text-anchor","start").style("font-size","10px")});
